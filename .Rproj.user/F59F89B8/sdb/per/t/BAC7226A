{
    "contents" : "\n# required packages\nlibrary(\"effects\")\nrequire(plyr)\n\ntritae<-read.table(\"tritae\")\ngelidus<-read.table(\"gelidus\")\npseudo<-read.table(\"pseudo\")\npedit<-read.table(\"pedi\")\n\ndat.func<-function(dat){\n  # sum all chicken, pigeons and duck in a household into a new column (Bird)\n  dat.bird<-ddply(dat,.(LTid),transform, Bird=sum(Chick,Duck,Pigeon))\n  # take off one row for the chicken farm (500 birds)- does not fit with\n  # typical household data\n  dat<-dat.bird[-110,]\n  return(dat)\n}\n\n\n\n# Culex tritaeniorhynchus\ntritae1<-dat.func(tritae)\t\nt1<-lm(log(tritae1$Females +1 ) ~ tritae1$Cattle*tritae1$Goat*tritae1$Bird*tritae1$Human)\ndrop1(t1,test=\"F\")\nt2<-update(t1,.~. -tritae1$Cattle:tritae1$Goat:tritae1$Bird:tritae1$Human)\ndrop1(t2,test=\"F\")\nt3<-update(t2,.~. -tritae1$Cattle:tritae1$Goat:tritae1$Human)\ndrop1(t3,test=\"F\")\nt4<-update(t3, .~. -tritae1$Cattle:tritae1$Goat:tritae1$Bird)\ndrop1(t4,test=\"F\")\nt5<-update(t4,.~. -tritae1$Cattle:tritae1$Goat)\ndrop1(t5,test=\"F\")\nt6<-update(t5,.~. -tritae1$Cattle:tritae1$Bird:tritae1$Human)\ndrop1(t6,test=\"F\")\nt7<-update(t6,.~. -tritae1$Cattle:tritae1$Human)\ndrop1(t7,test=\"F\")\nt8<-update(t7,.~. -tritae1$Goat:tritae1$Bird:tritae1$Human)\ndrop1(t8,test=\"F\")\nt9<-update(t8,.~. -tritae1$Goat:tritae1$Human)\ndrop1(t9,test=\"F\")\nt10<-update(t9,.~. -tritae1$Bird:tritae1$Human)\ndrop1(t10,test=\"F\")\nt11<-update(t10,.~. -tritae1$Goat:tritae1$Bird)\ndrop1(t11,test=\"F\")\nt12<-update(t11,.~. -tritae1$Human)\ndrop1(t12,test=\"F\")\nt13<-update(t12,.~. -tritae1$Goat)\ndrop1(t13,test=\"F\")\nsummary(t13)\n\ntnull<-lm(log(Females +1) ~ 1, data=tritae1)\n\n\n\n# Culex gelidus\ngel<-dat.func(gelidus)\ng1<-lm(log(gel$Females + 1) ~gel$Cattle*gel$Goat*gel$Bird*gel$Human)\ndrop1(g1,test=\"F\")\ng2<-update(g1,.~. -gel$Cattle:gel$Goat:gel$Bird:gel$Human)\ndrop1(g2,test=\"F\")\ng3<-update(g2,.~. -gel$Cattle:gel$Goat:gel$Bird)\ndrop1(g3,test=\"F\")\ng4<-update(g3,.~. -gel$Cattle:gel$Bird:gel$Human)\ndrop1(g4,test=\"F\")\ng5<-update(g4,.~. -gel$Cattle:gel$Goat:gel$Human)\ndrop1(g5,test=\"F\")\ng6<-update(g5,.~. -gel$Cattle:gel$Goat)\ndrop1(g6,test=\"F\")\ng7<-update(g6,.~. -gel$Cattle:gel$Human)\ndrop1(g7,test=\"F\")\ng8<-update(g7,.~. - gel$Goat:gel$Bird:gel$Human)\ndrop1(g8,test=\"F\")\ng9<-update(g8,.~. -gel$Goat:gel$Human)\ndrop1(g9,test=\"F\")\ng10<-update(g9,.~.-gel$Bird:gel$Human)\ndrop1(g10,test=\"F\")\ng11<-update(g10,.~. -gel$Human)\ndrop1(g11,test=\"F\")\ng12<-update(g11,.~. -gel$Goat:gel$Bird)\ndrop1(g12,test=\"F\")\ng13<-update(g12,.~. -gel$Goat)\ndrop1(g13,test=\"F\")\n\ngelnull<-lm(log(Females +1) ~ 1,data=gel)\n\n\n\n# Culex pseudovishnui\npsv<-dat.func(pseudo)\np1<-lm(log(psv$Females + 1) ~psv$Cattle*psv$Goat*psv$Bird*psv$Human)\ndrop1(p1,test=\"F\")\np2<-update(p1,.~. -psv$Cattle:psv$Goat:psv$Bird:psv$Human)\ndrop1(p2,test=\"F\")\np3<-update(p2,.~. -psv$Cattle:psv$Goat:psv$Bird)\ndrop1(p3,test=\"F\")\np4<-update(p3,.~. -psv$Cattle:psv$Bird:psv$Human)\ndrop1(p4,test=\"F\")\np5<-update(p4,.~. -psv$Cattle:psv$Goat:psv$Human)\ndrop1(p5,test=\"F\")\np6<-update(p5,.~. -psv$Cattle:psv$Goat)\ndrop1(p6,test=\"F\")\np7<-update(p6,.~. -psv$Cattle:psv$Human)\ndrop1(p7,test=\"F\")\np8<-update(p7,.~. -psv$Goat:psv$Bird:psv$Human)\ndrop1(p8,test=\"F\")\np9<-update(p8,.~. -psv$Goat:psv$Human)\ndrop1(p9,test=\"F\")\np10<-update(p9,.~. -psv$Bird:psv$Human)\ndrop1(p10,test=\"F\")\np11<-update(p10,.~. -psv$Human)\ndrop1(p11,test=\"F\")\np12<-update(p11,.~. -psv$Goat:psv$Bird)\ndrop1(p12,test=\"F\")\np13<-update(p12,.~. -psv$Goat)\ndrop1(p13,test=\"F\")\n\npsvnull<-lm(log(Females +1) ~ 1,data=psv)\n\n\n\n# An peditaeniatus\npedi<-dat.func(pedit)\na1<-lm(log(pedi$Females + 1) ~pedi$Cattle*pedi$Goat*pedi$Bird*pedi$Human)\ndrop1(a1,test=\"F\")\na2<-update(a1,.~. -pedi$Cattle:pedi$Goat:pedi$Birdpedi$Human)\ndrop1(a2,test=\"F\")\na3<-update(a2,.~. -pedi$Cattle:pedi$Goat:pedi$Bird)\ndrop1(a3,test=\"F\")\na4<-update(a3,.~. -pedi$Cattle:pedi$Bird:pedi$Human)\ndrop1(a4,test=\"F\")\na5<-update(a4,.~. -pedi$Cattle:pedi$Goat:pedi$Human)\ndrop1(a5,test=\"F\")\na6<-update(a5,.~. -pedi$Cattle:pedi$Goat)\ndrop1(a6,test=\"F\")\na7<-update(a6,.~. -pedi$Cattle:pedi$Human)\ndrop1(a7,test=\"F\")\na8<-update(a7,.~. -pedi$Goat:pedi$Bird:pedi$Human)\ndrop1(a8,test=\"F\")\na9<-update(a8,.~. -pedi$Goat:pedi$Bird)\ndrop1(a9,test=\"F\")\na10<-update(a9,.~. -pedi$Goat:pedi$Human)\ndrop1(a10,test=\"F\")\na11<-update(a10,.~. -pedi$Goat)\ndrop1(a11,test=\"F\")\na12<-update(a11,.~. -pedi$Bird:pedi$Human)\ndrop1(a12,test=\"F\")\na13<-update(a12,.~. -pedi$Human)\ndrop1(a13,test=\"F\")\n\npedinull<-lm(log(Females +1) ~ 1,data=pedi)\n\n# Plotting\n\n\n# fig. 3\nBird<-c(1:120)\nCattle<-rep(0,120)\nnew.data<-cbind.data.frame(Bird,Cattle)\n\nt<-lm(log(Females +1) ~ Bird*Cattle,data=tritae1)\np<-lm(log(Females +1) ~ Bird*Cattle,data=psv)\ng<-lm(log(Females +1) ~ Bird*Cattle,data=gel)\na<-lm(log(Females +1) ~ Bird*Cattle,data=pedi)\n\nt.predict<-predict(t,type=\"response\",newdata=new.data,interval=\"confidence\")\npsv.predict<-predict(p,type=\"response\",newdata=new.data,interval=\"confidence\")\ngel.predict<-predict(g,type=\"response\",newdata=new.data,interval=\"confidence\")\npedi.predict<-predict(a,type=\"response\",newdata=new.data,interval=\"confidence\")\n\nbird.plot<-function(bird=Bird,dat,spp=expression(paste(italic(\"Cx. tritaeniorhynchus\")))){\n  plot(bird,exp(dat[,1]),type=\"l\",log=\"y\",bty=\"n\",lwd=1,cex.main=0.8,cex.axis=0.6,col=\"#604A7B\",ylim=c(1,60000),main=spp)\n  lines(x=bird,y=exp(dat[,2]),lty=2,lwd=1,col=\"black\")\n  lines(x=bird,y=exp(dat[,3]),lty=2,lwd=1,col=\"black\")\n  legend(\"topleft\",legend=c(\"Predicted value\",\"95% confidence limits\"),bty=\"n\",lty=c(1,2),col=c(\"#604A7B\",\"black\"),cex=0.6,lwd=1)\n}\n\ntiff(\"Fig3.tiff\", height = 4, width = 4, units = 'in', compression=\"lzw\", res=400)\npar(mai=c(1,1,1,0),mar=c(2,2,2,1),mfcol=c(2,2),oma=c(1,1,0,1),cex=0.5,ylog=T)\n\nbird.plot(dat=t.predict)\nbird.plot(dat=psv.predict,spp=expression(paste(italic(\"Cx. pseudovishnui\"))))\nbird.plot(dat=gel.predict,spp=expression(paste(italic(\"Cx. gelidus\"))))\nbird.plot(dat=pedi.predict,spp=expression(paste(italic(\"An. peditaeniatus\"))))\nmtext(\"Number of birds\",side=1,outer=T,line=0,cex=0.5)\nmtext(\"Number of female mosquitoes per trap\",side=2,outer=T,line=0,cex=0.5)\n\ndev.off()\n\n\n# fig. 4\nBird<-rep(0,12)\nCattle<-c(1:12)\nnew.data<-cbind.data.frame(Bird,Cattle)\nt.predict2<-predict(t,type=\"response\",newdata=new.data,interval=\"confidence\")\npsv.predict2<-predict(p,type=\"response\",newdata=new.data,interval=\"confidence\")\ngel.predict2<-predict(g,type=\"response\",newdata=new.data,interval=\"confidence\")\npedi.predict2<-predict(a,type=\"response\",newdata=new.data,interval=\"confidence\")\n\ntiff(\"Fig4.tiff\", height = 3.5, width = 3, units = 'in', compression=\"lzw\", res=400)\npar(mai=c(1,1,0.8,0),mar=c(2,2,1,0),mfcol=c(2,2),oma=c(1,1,0,0),cex=0.5,ylog=T)\n\ncattle.plot<-function(cattle=Cattle,dat,spp=expression(paste(italic(\"Cx. tritaeniorhynchus\")))){\n  plot(cattle,exp(dat[,1]),type=\"l\",lwd=1,log=\"y\",cex.main=1,col=\"#604A7B\",bty=\"n\",ylim=c(1,30000),main=spp,cex.axis=0.6,xlab=\"Number of cattle\",ylab=\"Number of female mosquitoes per trap\")\n  lines(x=cattle,y=exp(dat[,2]),lty=2,lwd=1, col=\"#604A7B\")\n  lines(x=cattle,y=exp(dat[,3]),lty=2,lwd=1, col=\"#604A7B\")\n  legend(\"topleft\",legend=c(\"Predicted value\",\"95% confidence limits\"),bty=\"n\",lty=c(1,2),lwd=1,col=c(\"#604A7B\",\"black\"),cex=0.4)\n}\n\ncattle.plot(dat=t.predict2)\n\ncattle.plot(dat=psv.predict2,spp=expression(paste(italic(\"Cx. pseudovishnui\"))))\ncattle.plot(dat=gel.predict2,spp=expression(paste(italic(\"Cx. gelidus\"))))\ncattle.plot(dat=pedi.predict2,spp=expression(paste(italic(\"An. peditaeniatus\"))))\nmtext(\"Number of cattle\",side=1,outer=T,line=0,cex=0.5)\nmtext(\"Number of female mosquitoes per trap\",side=2,outer=T,line=0,cex=0.5)\n\n\ndev.off()\n\n\n\n\n",
    "created" : 1446220401759.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3921684845",
    "id" : "BAC7226A",
    "lastKnownWriteTime" : 1446220600,
    "path" : "~/GitHub/mosquito-Rajshahi/fig3.4.R",
    "project_path" : "fig3.4.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}